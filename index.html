<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hera English School â€“ Online MCQs</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:#eef2ff;
}
.container{
  max-width:900px;
  margin:auto;
  padding:20px;
}
.card{
  background:#fff;
  border:2px solid #c7d2fe;
  border-radius:16px;
  padding:20px;
  margin-bottom:25px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}
h2,h3{
  text-align:center;
  color:#1e40af;
}
input,textarea,select,button{
  width:100%;
  padding:12px;
  margin:8px 0;
  font-size:15px;
  border-radius:10px;
  border:1px solid #c7d2fe;
}
button{
  background:#2d5be3;
  color:#fff;
  border:none;
  font-weight:600;
  cursor:pointer;
}
button:hover{background:#1e40af}
.hidden{display:none}

/* Exam */
.options label{
  display:block;
  padding:12px;
  margin:8px 0;
  border-radius:10px;
  border:1px solid #c7d2fe;
  background:#f8faff;
  cursor:pointer;
}
.options input{margin-right:10px}
.palette span{
  display:inline-block;
  width:36px;
  height:36px;
  line-height:36px;
  margin:4px;
  border-radius:50%;
  background:#e0e7ff;
  text-align:center;
  font-weight:600;
  cursor:pointer;
}
.palette .done{
  background:#2d5be3;
  color:#fff;
}
.nav{
  display:flex;
  gap:10px;
  margin-top:15px;
}
@media(max-width:600px){
  .nav{flex-direction:column}
}
</style>
</head>

<body>
<div class="container">

<h2>ğŸ“˜ Hera English School â€“ Online MCQs</h2>

<!-- TEACHER LOGIN -->
<div class="card" id="teacherLogin">
<h3>ğŸ” Teacher Login</h3>
<input type="password" id="teacherPassword" placeholder="Teacher Password">
<button onclick="loginTeacher()">Login</button>
</div>

<!-- TEACHER PANEL -->
<div class="card hidden" id="teacherPanel">
<h3>ğŸ‘©â€ğŸ« Teacher Panel</h3>

<input id="testName" placeholder="Test Name">

<textarea id="questionText" placeholder="Question"></textarea>
<input id="a" placeholder="Option A">
<input id="b" placeholder="Option B">
<input id="c" placeholder="Option C">
<input id="d" placeholder="Option D">

<select id="correct">
  <option value="0">Correct: A</option>
  <option value="1">Correct: B</option>
  <option value="2">Correct: C</option>
  <option value="3">Correct: D</option>
</select>

<button onclick="addQuestion()">Add Question</button>
<button onclick="saveTest()">Save / Update Test</button>

<h4>Questions Added</h4>
<div id="questionList"></div>
</div>

<!-- STUDENT PANEL -->
<div class="card">
<h3>ğŸ§‘â€ğŸ“ Student Panel</h3>
<button onclick="startExam()">Start Test</button>

<div id="exam" class="hidden">
<div class="palette" id="palette"></div>
<h3 id="qTitle"></h3>
<div class="options" id="options"></div>

<div class="nav">
<button onclick="prev()">Previous</button>
<button id="nextBtn" onclick="next()">Next</button>
<button onclick="submit()">Submit</button>
</div>
</div>
</div>

</div>

<script>
/* ---------- FIREBASE ---------- */
const firebaseConfig = {
  apiKey: "AIzaSyChhkiu5e6fKVowh2RRvkegVdTwn7yV8Zc",
  authDomain: "hera-mcqs.firebaseapp.com",
  projectId: "hera-mcqs",
  storageBucket: "hera-mcqs.firebasestorage.app",
  messagingSenderId: "284002289050",
  appId: "1:284002289050:web:e98f219b72f5c7cc3c6623"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* ---------- TEACHER ---------- */
const PASSWORD = "hera@123";
let questions = [];

function loginTeacher(){
  if(teacherPassword.value === PASSWORD){
    teacherLogin.classList.add("hidden");
    teacherPanel.classList.remove("hidden");
  }else{
    alert("Wrong password");
  }
}

function addQuestion(){
  questions.push({
    q:questionText.value,
    o:[a.value,b.value,c.value,d.value],
    c:Number(correct.value)
  });
  questionText.value=a.value=b.value=c.value=d.value="";
  renderTeacherList();
}

function renderTeacherList(){
  questionList.innerHTML="";
  questions.forEach((q,i)=>{
    questionList.innerHTML+=`<p>${i+1}. ${q.q}</p>`;
  });
}

function saveTest(){
  db.collection("tests").doc("active").set({questions});
  alert("Test saved");
}

/* ---------- STUDENT ---------- */
let examQ=[], ans=[], idx=0;

function startExam(){
  db.collection("tests").doc("active").get().then(doc=>{
    examQ = shuffle(doc.data().questions).slice(0,30);
    ans = Array(examQ.length).fill(null);
    idx = 0;
    exam.classList.remove("hidden");
    showQ();
  });
}

function showQ(){
  const q = examQ[idx];
  qTitle.innerText = `Q${idx+1}. ${q.q}`;
  options.innerHTML="";
  q.o.forEach((op,i)=>{
    options.innerHTML+=`
    <label>
      <input type="radio" name="opt" ${ans[idx]===i?"checked":""}
      onclick="ans[${idx}]=${i};drawPalette()">
      ${op}
    </label>`;
  });
  drawPalette();
  nextBtn.style.display = idx===examQ.length-1 ? "none" : "block";
}

function drawPalette(){
  palette.innerHTML="";
  ans.forEach((v,i)=>{
    palette.innerHTML+=`<span class="${v!==null?'done':''}"
    onclick="idx=${i};showQ()">${i+1}</span>`;
  });
}

function next(){ if(idx<examQ.length-1){idx++;showQ();}}
function prev(){ if(idx>0){idx--;showQ();}}

function submit(){
  let score=0;
  examQ.forEach((q,i)=>{ if(ans[i]===q.c) score++; });
  alert(`Test Submitted\nScore: ${score}/${examQ.length}`);
  exam.classList.add("hidden");
}

function shuffle(a){ return [...a].sort(()=>Math.random()-0.5); }
</script>

</body>
</html>
